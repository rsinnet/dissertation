\documentclass[twocolumn]{article}

\usepackage{amsmath,amssymb,amsthm,mathrsfs}
\usepackage[top=1.25in, bottom=1.25in, left=.75in, right=.75in]{geometry}

\usepackage[english]{babel}
\usepackage{fancyhdr,lastpage}

\usepackage{../rsinnet}

\author{R.~W.~Sinnet}
\title{On the Stability of Energy Shaping}

\pagestyle{fancy} \fancyhf{}
\lhead[]{On the Stability of Energy Shaping}
\rhead[]{R. W. Sinnet}
%%HASH%%
\cfoot[]{-\thepage\ of \pageref{LastPage}-}
\rfoot[]{Revised \today}

\begin{document}
\maketitle
\thispagestyle{fancy}

\section*{Overview}
The goal is to show that the energy shaping control law does not locally destabilize the system.
%
Formally, this means that, given an exponentially-stable limit cycle in a dynamical system, application of energy shaping results in a closed-loop system which is exponentially stable.

\section{Setup}

Consider a hybrid dynamical system ith total energy
\begin{align*}
  E(x) &= E(\q, \dq = \frac{1}{2} \dq^{T} M(\q) \dq + U(\q).
\end{align*}
where the first term represents the kinetic energy and the second term represents the potential energy.
%
The system has coordinates $x = (\q^T, \dq^T)^T \in T\Q = \D$ which take values in the {\em domain of admissibility}, $\D$.

The discrete aspect comes from a {\em guard constraint}, $h : \Q \to \R^{+}$, which leads to a transverse plane, $\S \subset \D$, called the {\em switching surface}.
%
The uncontrolled hybrid system can be written
\begin{align}
  \Sigma = \left\{
  \begin{array}{l l}
    {\dot x} = f(x), & x \in \D \setminus \S,\\
    x^{+} = \Delta(x^{-}), &x \in \D \cap \S,
  \end{array}\right.
  \label{eq:hsys}
\end{align}
Under the action of control effort $u$, the corresponding hybrid control system has the form
\begin{align}
  \Sigma_{c} = \left\{
  \begin{array}{l l}
    {\dot x} = f(x) + g(x) \, u, & x \in \D \setminus \S,\\
    x^{+} = \Delta(x^{-}), &x \in \D \cap \S,
  \end{array}\right.
  \label{eq:csys}
\end{align}
for control values in a set $\U \subseteq \R^{m}$.
%
For the continuous dynamics, construct a Lyapunov function, $V : \D \to \R^{+}$, of the form
\begin{align}
  \label{eq:lyap}
  V(x) = \frac{1}{2} (E(x) - \Eref)^2.
\end{align}
Consider the energy shaping controller
\begin{align}
  \label{eq:es-qp} \tag {QP}
  \mu(x, \epsilon) = \argmin_{u(x) \in \R^{n}} \ & u(x)^T u(x)\\
  \nonumber
  \mbox{s.t. } & L_{f} V(x) + L_{g} V(x) u(x) + \epsilon V(x) \leq 0.
\end{align}
Applying this to the system \eqref{eq:hsys} results in the closed-loop dynamics
\begin{align}
  \label{eq:hsys-cl}
  \Sigma = \left\{
  \begin{array}{l l}
    {\dot x} = f(x) + g(x) \, \mu(x, \epsilon), & x \in \D \setminus \S,\\
    x^{+} = \Delta(x^{-}), &x \in \D \cap \S.
  \end{array}\right.
\end{align}

\section{Sketch of the Proof}

Exponential stability of the unperturbed system \eqref{eq:hsys} implies that there exists a region round the fixed point $\xst$ in which the state will converge to the limit cycle.
%
For simplicity, let's consider a ball of radius $\delta$, $\mathcal{B}\delta$, within this region and centered about the fixed point.
%
Because energy is smooth, there exists a level set of energy within this ball corresponding to the energy of the limit cycle, $E(x) = \xst$, and the guard condition applies as well, so this is a codimension-two submanifold, $\left.\S\right|_{\Es} = \{ x \in \D \cap \S | E(x) = \Es \}$.
%
If the system is stable within this this submanifold and the convergence of the discrete dynamics is sufficiently large to overcome divergence in the continuous dynamics due to the energy shaping controller, the exponential stability is guaranteed.


Additionally, it should be noted that, as the perturbations approach zero, the divergence from the fixed point due the continuous dynamics approaches zero.
%
Thus it seems logical to assume that sufficiently small $\epsilon$ for the energy shaping controller \eqref{eq:es-qp} applied to a system \eqref{eq:hsys} which is exponentially stable will result in exponential stability of the controlled system \eqref{eq:hsys-cl}.

\section{Zero Dynamics Formulation}

In order to understand the nature of energy shaping, consider breaking up the system into two sets of coordinates.
%
By considering level sets of energy, the continuous dynamics can be expressed as
\begin{align}
  \nonumber
  {\dot \eta} &= f(\eta, \zeta) + g(\eta, \zeta) \, u,\\
  {\dot \zeta} &= q(\eta, \zeta),
  \label{eq:zd-vfield}
\end{align}
%
with states $\eta \in \Eta$ and $\zeta \in \Zeta$ and control inputs $u \in \U$.
%
The vector fields $f$, $g$, and $q$ are assumed to be locally Lipschitz.
%
The natural choice of transformation to convert the continuous dynamics of \eqref{eq:csys} to \eqref{eq:zd-vfield} will be based on energy.

Under the transformation
\begin{align}
  \eta = E(x) - \Eref,
\end{align}
it is clear that $f(0, \zeta) = 0$.
%
In other words, the zero dynamics manifold $\Zeta$ is the restricted subset of $X$ such that $\eta = 0$.
%
This is used to express the control Lyapunov function as
\begin{align}
  V(\eta) = \frac{1}{2} \eta^{2}.
\end{align}

Exponential stability of the $\eta$ dynamics is guaranteed if a {\em control Lyapunov function (CLF)} exists satisfying
\begin{align}
  \label{eq:lyap-cond-nrg-es}
  &c_{1} \| \eta \|^{2} \leq \V(\eta) \leq c_{2} \| \eta \|^2,\\
  \nonumber
  &\inf_{u \in \U} \left[ L_{f} \V(\eta, \zeta) + L_{g} \V(\eta, \zeta) \, u + c_{3} \V(\eta) \right] \leq 0,
\end{align}
for all $(\eta, \zeta) \in \Eta \times \Zeta$.
%
It is easy to see that the first inequality is satisfied for $c_{1} \leq \frac{1}{2}$ and $c_{2} \geq \frac{1}{2}$.
%
Define the set
\begin{align}
  \K = \left\{ u \in \U : L_{f} \V(\eta, \zeta) + L_{g} \V(\eta, \zeta) \, u + c_{3} \V(\eta) \leq 0 \right\}.
\end{align}
For the CLF \eqref{eq:lyap-cond-nrg-es} with any locally Lipschitz feedback control law $u : \Eta \times \Zeta \to \K$, it follows that solutions satisfy
\begin{align*}
  \| \eta(t) \| \leq \sqrt{\frac{c_{2}}{c_{1}}} e^{-\frac{c_{3}}{2} t} \| \eta(0) \|.
\end{align*}

Now consider the hybrid control system
\begin{align}
  \label{eq:hcsys}
  {\bar \Sigma}_{c} = \left\{
  \begin{array}{l l}
    \begin{array}{r c l}
      {\dot \eta} &=& f(\eta, \zeta) + g(\eta, \zeta) \, u\\
      {\dot \zeta} &=& q(\eta, \zeta)
    \end{array} & \mbox{ if } (\eta, \zeta) \in \D \setminus \S,\\
    \begin{array}{r c l}
      \eta^{+} &=& \Delta_{\eta}(\eta^{-}, \zeta^{-})\\
      \zeta^{+} &=& \Delta_{\zeta}(\eta^{-}, \zeta^{-})
    \end{array} & \mbox{ if } (\eta, \zeta) \in \S,
  \end{array}\right.
\end{align}


\section{Proof of Main Result}

Consider the 

First, let us define the domain and switching surface of the system:
\begin{align}
  \D &= \left\{ (\eta, \zeta) \in \Eta \times \Zeta : h(\eta, \zeta) \geq 0 \right\},\\
  \nonumber
  \S &= \left\{ (\eta, \zeta) \in \Eta \times \Zeta : h(\eta, \zeta) = 0 \mbox{ and } {\dot h}(\eta, \zeta) < 0 \right\}.
\end{align}

Now Theorem 1 can be proven:
\begin{proof}
  By the discrete converse Lyapunov theorem, exponential stability of $\Orbit$ implies the existence of a discrete Lyapunov function $\V : B_{\delta}(0) \cap \S \to \Rnn$ satisfying
  %
  \begin{align}
    \nonumber
    r_{1} \| x \|^{2} \leq \Vn(x) \leq r_{2} \| x \|^2\\
    \Vn(\Pe(x)) - \Vn(x) \leq -r_{3} \| x \|^{2}
    \label{eq:lyap-cond-nom}
  \end{align}
for some $r_{1}, r_{2}, r_{3} \in \Rnn$.
%
In addition, consider the CLF associated with \eqref{eq:es-qp} which is $\Ve : \X \to \Rnn < 0$.
%
Denote by $\Vee = \VeS$ its restriction to the switching surface $\S$.
%
Using these Lyapunov functions, define the candidate Lyapunov function
\begin{align}
  \VP(x) = \Vn(x) + \sigma \Vee(x).
\end{align}

From \eqref{} and \eqref{eq:lyap-cond-nom}, it is apparent that $\VP(x)$ is bounded as follows:
\begin{align}
  \left( r_{1} + \sigma c_{1} \right) \| x \|^{2} \leq \VP(x) \leq \left( r_{2} + \sigma \frac{c_{2}}{\epsilon^{2}}  \right) \| x \|^{2}.
\end{align}

It must be shown that
\begin{align}
  \VP(\Pe(x)) - \VP(x) \leq -\alpha \| x \|^{2}.
\end{align}

First note that
\begin{align}
  \VP(\Pe(x)) - \VP(x) = \Vn(\Pe(x)) - \Vn(x) \hspace{1.2cm}\\
  \nonumber
  \mbox{} + \sigma(\Vee(\Pe(x)) - \Vee(x))
\end{align}

Thus, it remains to be shown that
\begin{align}
  \sigma(\Vee(\Pe(x)) - \Vee(x)) \leq -\beta \| x \|^{2}.
\end{align}
for $\beta \in \Rpd$.

\end{proof}

\end{document}
